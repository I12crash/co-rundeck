Rundeck
=======

## What is Rundeck?

RunDeck is cross-platform open source software that helps you automate ad-hoc and routine procedures in data center or cloud environments. RunDeck allows you to run tasks on any number of nodes from a web-based or command-line interface. RunDeck also includes other features that make it easy to scale up your scripting efforts including: access control, workflow building, scheduling, logging, and integration with external sources for node and option data.

## Image features

1. Minimalistic image (based on Alpine Linux)
2. DB and local file storage configuration support (Postgres default, MySQL working)
3. SSL certificate support (self-signed or generated by a certification authority)
4. Email support
5. [Active Directory](https://runops.wordpress.com/2015/11/20/configure-rundeck-to-use-active-directory-authentication/) support

## Plugins Included
1. [Ansible Plugin](https://github.com/Batix/rundeck-ansible-plugin/releases) 
2. [Slack Webhook Plugin](https://github.com/higanworks/rundeck-slack-incoming-webhook-plugin/releases/tag/v0.6.dev)

## How to use

### Clone the repo

```git clone https://github.com/rch317/ECM.git```

Make sure you change your current folder to rundeck's project folder

### Build your rundeck image

```
Rundeck/build.sh
```

### Create your new rundeck container

#### Example #1 - Run using local storage, internal IP, and Active Directory authentication 

```
docker run -d \
	-v /etc/localtime:/etc/localtime:ro \
	-v /etc/timezone:/etc/timezone:ro \
	-p 4440:4440 \
	-p 4443:4443 \
	-e SERVER_URL=http://10.20.20.2:4440 \
	-e AD_HOST=10.20.20.10 \
	-e AD_PORT=389 \
	-e AD_BINDN="CN=SSSD,CN=Users,DC=clearobject,DC=lab" \
	-e AD_BINPASSWORD=XXXXXXXXXXXXXXX \
	-e AD_USERBASEDN="DC=clearobject,DC=lab" \
	-e AD_ROLEBASEDN="DC=clearobject,DC=lab" \
	--name rundeck -h rundeck \
	rundeck
```

Test: [http://10.20.20.10:4440/](http://10.20.20.10:4440/)

#### Example #2 - Run using an external SSL certificate, local storage, and Active Directory authentication

```
docker run -d \
	-v /etc/localtime:/etc/localtime:ro \
	-v /etc/timezone:/etc/timezone:ro \
	-p 80:4440 \
	-p 443:4443 \
	-e SERVER_SECURED_URL=https://10.20.20.10 \
  	-e PFX_CERTIFICATE_URL=/etc/rundeck/ssl/example.pfx \
  	-e PFX_CERTIFICATE_PASSWORD=yourpasswordhere \
	-e AD_HOST=10.20.20.10 \
	-e AD_PORT=389 \
	-e AD_BINDN="CN=SSSD,CN=Users,DC=clearobject,DC=lab" \
	-e AD_BINPASSWORD=XXXXXXXXXXXXXXX \
	-e AD_USERBASEDN="DC=clearobject,DC=lab" \
	-e AD_ROLEBASEDN="DC=clearobject,DC=lab" \
	--name rundeck -h rundeck \
	rundeck
```

Test: [https://[yourdomain.example.com]:4443](https://[yourdomain.example.com]:4443)

## Arguments available
```
USER SETTINGS
   DEFAULT_ADMIN_USER          Set the default admin user (defaults to "admin")
   DEFAULT_ADMIN_PASSWORD      Set the default admin's password (defaults to "admin"). Must be at least 6 chars long
   DEFAULT_USER                Set the default user (defaults to "user")
   DEFAULT_PASSWORD            Set the default user's password (defaults to "user")

SERVER SETTINGS
   SERVER_MEMORY               Increases maximum permanent generation size
   SERVER_URL                  Sets Rundeck's grails.serverURL
   SERVER_PORT                 Sets Rundeck's listening port (defaults to "4440")
   USE_INTERNAL_IP             When SERVER_URL is undefined, use the container's eth0 address (otherwise try to guess external)

SSL SETTINGS
   SERVER_SECURED_URL          Sets Rundeck's grails.serverURL and HTTPS protocol
   SERVER_SECURED_PORT         Sets Rundeck's listening secured port (defaults to "4443")
   PFX_CERTIFICATE_URL         Location (file, folder or URL) of the PFX certificate to be used in the SSL certificate; if not provided then a personal SSL will be generated
   PFX_CERTIFICATE_PASSWORD    Password used to decrypt the private contents of your PFX file

DB SETTINGS
   JDBC_DRIVER                 Enables interaction with a db (defaults to "postgresql", another common option is "mysql")
   DB_HOST                     Database server host address (if not provided then local storage used)
   DB_PORT                     Database server listening port (defaults to "5432")
   DB_NAME                     Rundeck's database name (defaults to "rundeck"; the database won't be created for you, you need to create it upfront and prior to running your Rundeck container)
   DB_USER                     Database username (defaults to "rundeck")
   DB_PASSWORD                 Database password (defaults to "rundeck")

EMAIL SETTINGS
   MAIL_HOST                   Email server host address (if not provided then no email notifications will be available)
   MAIL_PORT                   Email server port number (defaults to "25")
   MAIL_FROM                   From email account
   MAIL_USER                   Email server username
   MAIL_PASSWORD               Email server password

ACTIVE DIRECTORY SETTINGS
   AD_HOST                     Active Directory (AD) server to be used
   AD_PORT                     AD server port number (defaults to "389")
   AD_BINDN                    Username used to query your AD in distinguised name (DN) form  e.g. "cn=myusername,dc=example,dc=com" (https://msdn.microsoft.com/en-us/library/windows/desktop/aa366101(v=vs.85).aspx)
   AD_BINPASSWORD              Password used to query your AD in clear text
   AD_USERBASEDN               Base DN to search for users, this is the OU which recursive searches for users will be performed on, e.g. "ou=People,dc=test1,dc=example,dc=com"
   AD_ROLEBASEDN               Base DN for role membership search, this is where your "rundeck" AD user group is, e.g. "ou=Groups,dc=test1,dc=example,dc=com".
```
